---
source_url: https://docs.appian.com/suite/help/25.3/Web_API_Tutorial.html
original_path: Web_API_Tutorial.html
version: "25.3"
---

Free cookie consent management tool by [TermsFeed](https://www.termsfeed.com/)

# Web API Tutorial

Share

Share via

LinkedIn

Reddit

Email

Copy Link

* * *

Print

Get External Events Data with Appian Integrations

Learn how to display a list of live performances in Appian by pulling data from an external system called SeatGeek.

This page provides step-by-step guidance on creating a web API to retrieve a JSON-encoded list of records.

-   To learn about web APIs and their configuration options, see [Web APIs](Web_APIs.html).
-   To learn the basic steps involved with creating an API, see [Creating Web APIs](Designing_Web_APIs.html).
-   To learn about web API authentication, see [Web API Authentication](Web_API_Authentication.html).

## Introduction

Web APIs allow a third-party system to get data from Appian or cause Appian to do something.

For example, let's imagine you have been asked to make employee information available to a staffing agency contracted by your organization. The agency needs access to current employee information stored in an Appian record type, so we'll build a web API that lets the agency query that data.

Appian provides a low-code experience for configuring your web APIs, so it’s much like configuring an [expression rule](Expression_Rules.html). This tutorial explains how to create a sample web API using a template. The API will query a list of employees from the Employee record type, and return the list of employees as a JSON-encoded list.

This tutorial contains three steps:

1.  [Create the web API](#create-a-web-api).
2.  [Test your configuration](#test-it-out).
3.  [Filter the employees retrieved by the API](#filter-by-department).

## Setup

Before you can create the web API, you first need to create the record type that you'll use to query data from. To create the record type used in this tutorial, complete the [Database-Backed Record Type Tutorial](Records_Tutorial.html).

The Database-Backed Record Type Tutorial will walk you through creating an Employee record type that uses a database table as the source and has data sync enabled.

Once you've configured the Employee record type, you can start building your web API.

## Create a web API

When you create the web API, you'll specify the record type the API will query, the name of the API object, and the endpoint. The endpoint is used as part of the web API's URL to identify it and in log files for network devices and servers.

To create the web API:

1.  In the **Build** view, click **NEW > Web API**.
2.  Choose the **QUERY RECORD TYPE** template.
3.  In the **Create Web API** dialog, configure the following properties:

    | Property | Description |
    | --- | --- |
    | **Record Type** | Select the `AT Employee` record type. |
    | **Name** | Enter `AT Query Employees`. |
    | **Description** | Enter `Web API to retrieve employee data`. |
    | **Endpoint** | Enter `employees`. |

4.  Click **CREATE**.
5.  In the **Review Web API Security** dialog, keep the default security settings:
    -   Permissions for **Default (All Other Users)** should be set to **No Access**.
    -   Permissions for **AT Users** should be set to **Viewer**.
    -   Permissions for **AT Administrators** should be set to **Administrator**.
6.  Click **SAVE**. The web API opens in a new tab with an expression generated by the template.

    [![images/Web_API_Tutorial_screenshot_1.png](images/Web_API_Tutorial_screenshot_1.png)![](/suite/help/25.3/images/rn/zoom_magnify_center.png)](#img785)

    [![](images/Web_API_Tutorial_screenshot_1.png)](#_)

7.  On line 6, update the expression for the local variable `local!records` to reference specific fields from the record type. If you don't, only the primary key field from the record type will be returned.

    For example:

    ```
    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
     local!records: a!queryRecordType(
       recordType: recordType!AT Employee,
       fields: {
         recordType!AT Employee.fields.firstName,
         recordType!AT Employee.fields.lastName,
         recordType!AT Employee.fields.title,
         recordType!AT Employee.fields.startDate,
         recordType!AT Employee.fields.phoneNumber,
         recordType!AT Employee.relationships.department.fields.value
       },
       pagingInfo: a!pagingInfo(
         startIndex: 1,
         batchSize: 50
       )
     ).data,
    ```

## Test it out

Now that you've created the web API, let's test it out!

To test the default configuration:

1.  Click **Test Request**.

The **Test Results** section appears with the result of the expression. As you can see, it is a JSON-encoded list of values from the Employee record type.

[![images/Web_API_Tutorial_screenshot_2.png](images/Web_API_Tutorial_screenshot_2.png)![](/suite/help/25.3/images/rn/zoom_magnify_center.png)](#img786)

[![](images/Web_API_Tutorial_screenshot_2.png)](#_)

This looks good, but let's filter out some of the data so we only see employees from the Engineering department.

## Filter by department

To filter the employees returned from the query, you'll use the _filters_ parameter in `a!queryRecordType` and add an [a!queryFilter()](fnc_system_a_queryfilter.html) expression.

However, instead of adding a static value to filter by (like "Engineering"), you'll use the [http! domain](Designing_Web_APIs.html#accessing-the-http-request) so you can dynamically filter the query using query parameters. Query parameters are appended to the end of the URL so you can pass specific values into your request.

You can use query parameters for a variety of reasons, but in this case, you'll use them to filter the data returned from the query.

To filter employees by department:

1.  In the expression editor, add the following to your expression:

    **Note:**  If you copy and paste this expression, you will need to change the record type references to use the record type reference in your environment.

    ```
    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    32
    33
    34
    35
    36
    37
    38
    39
    40
    41
    42
    43
     a!localVariables(
       /*
       * Use the queryRecordType() function to retrieve data for the
       * first 50 records and store this data in a local variable named local!records
       */
       local!records: a!queryRecordType(
         recordType: recordType!AT Employee,
         fields: {
           recordType!AT Employee.fields.firstName,
           recordType!AT Employee.fields.lastName,
           recordType!AT Employee.fields.title,
           recordType!AT Employee.fields.startDate,
           recordType!AT Employee.fields.phoneNumber,
           recordType!AT Employee.relationships.department.fields.value
         },
         pagingInfo: a!pagingInfo(startIndex: 1, batchSize: 50)`,`
    +    filters: a!queryFilter(
    +      field: recordType!AT Employee.relationships.department.fields.value,
    +      operator: "=",
    +      value: http!request.queryParameters.department
    +    )
       ).data,
       /*
       * Construct an HTTP response that contains the information that we just stored
       * in "local!records".
       */
       a!httpResponse(
         /*
         * Set an HTTP header that tells the client that the body of the response
         * will be JSON-encoded.
         */
         headers: {
           a!httpHeader(
             name: "Content-Type",
             value: "application/json"
           )
         },
         /*
         * JSON-encode the value of "local!records" and place it in the response body.
         */
         body: a!toJson(value: local!records)
       )
     )
    ```

2.  In the **Test Inputs** pane, under **Query Parameters**, click **New Query Parameter**.
3.  For **Name**, enter **department**.
4.  For **Value**, enter **Engineering**. Notice that the **URL** updates to include `?department=Engineering`.

    [![images/Web_API_Tutorial_screenshot_3.png](images/Web_API_Tutorial_screenshot_3.png)![](/suite/help/25.3/images/rn/zoom_magnify_center.png)](#img787)

    [![](images/Web_API_Tutorial_screenshot_3.png)](#_)

5.  Click **Set as default test values**.
6.  Click **Test Request**. In the **Test Results**, only employees in the Engineering department are returned.
7.  Click **SAVE**.

You can always replace the **Value** parameter with a different department. Try replacing **Sales** with one of the values below:

-   **Engineering**
-   **Finance**
-   **HR**
-   **Professional Services**

As you change the **Value** parameter, notice that the **URL** updates to match your changes.

### Handle null values

As you test your request, you may notice that if the **Value** parameter is null, the expression will error. This is because you can't pass a blank value into the _value_ parameter of `a!queryFilter()`.

To account for null values, you'll want to specify that the filter should only be applied when `http!request.queryParameters.department` is not null.

To account for null values:

1.  In the expression editor, add the _applyWhen_ parameter to `a!queryFilter`:

    ```
    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    32
    33
    34
    35
    36
    37
    38
    39
    40
    41
    42
    43
    44
    45
     a!localVariables(
     /*
     * Use the queryRecordType() function to retrieve data for the
     * first 50 records and store this data in a local variable named local!records
     */
     local!records: a!queryRecordType(
       recordType: recordType!AT Employee,
       fields: {
           recordType!AT Employee.fields.firstName,
           recordType!AT Employee.fields.lastName,
           recordType!AT Employee.fields.title,
           recordType!AT Employee.fields.startDate,
           recordType!AT Employee.fields.phoneNumber,
           recordType!AT Employee.relationships.department.fields.value
         },
       pagingInfo: a!pagingInfo(startIndex: 1, batchSize: 50),
       filters:
         a!queryFilter(
           field: recordType!AT Employee.relationships.department.fields.value,
           operator: "=",
           value: http!request.queryParameters.department`,`
    +      applyWhen: not(isnull(http!request.queryParameters.department))
         )
     ).data,
     /*
     * Construct an HTTP response that contains the information that we just stored
     * in "local!records".
     */
     a!httpResponse(
       /*
       * Set an HTTP header that tells the client that the body of the response
       * will be JSON-encoded.
       */
       headers: {
         a!httpHeader(
           name: "Content-Type",
           value: "application/json"
         )
       },
       /*
       * JSON-encode the value of "local!records" and place it in the response body.
       */
       body: a!toJson(value: local!records)
     )
     )
    ```

2.  Under **Query Parameters**, remove any department listed under the **Value** parameter.
3.  Click **TEST REQUEST**. The web API returns an unfiltered list of employees.

    [![images/Web_API_Tutorial_screenshot_5.png](images/Web_API_Tutorial_screenshot_5.png)![](/suite/help/25.3/images/rn/zoom_magnify_center.png)](#img788)

    [![](images/Web_API_Tutorial_screenshot_5.png)](#_)

4.  Click **SAVE**.

You did it! You made it through all of the steps to successfully create a web API to query employee data. You're ready to move on to the [Web API Tutorial - Level II](Web_API_Tutorial_-_Level_II.html) or start [creating your own web APIs](Designing_Web_APIs.html)!

## Feedback

Was this page helpful?

SHARE FEEDBACK

Loading...